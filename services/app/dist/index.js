(()=>{"use strict";var e={7280:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0});var n={server:{port:null!==(r=process.env.PORT)&&void 0!==r?r:3001,cors:{origin:"http://localhost:3000"}}};t.default=n},5955:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.tasksRepository=t.tasksQueryService=t.rolesRepository=t.projectMemberService=t.projectsMembersQueryService=t.projectsMembersRepository=t.projectsQueryService=t.projectsRepository=t.suggestionsCommentsRepository=t.suggestionsRepository=t.suggestionsQueryService=t.chatsRoomsRepository=t.chatsRoomsQueryService=t.authRepository=void 0;var o=n(r(7708)),i=n(r(4735)),u=n(r(7868)),a=n(r(5019)),s=n(r(9381)),c=n(r(4250)),l=n(r(2381)),f=r(6896),d=n(r(4784)),p=n(r(9985)),h=n(r(5610)),v=n(r(8611)),_=n(r(8540)),y=n(r(1195)),b=n(r(2886));f.container.register("authRepository",{useClass:d.default}),t.authRepository=f.container.resolve("authRepository"),f.container.register("chatsRoomsQueryService",{useClass:o.default}),f.container.register("chatsRoomsRepository",{useClass:i.default}),t.chatsRoomsQueryService=f.container.resolve("chatsRoomsQueryService"),t.chatsRoomsRepository=f.container.resolve("chatsRoomsRepository"),f.container.register("suggestionsQueryService",{useClass:a.default}),f.container.register("suggestionsRepository",{useClass:s.default}),f.container.register("suggestionsCommentsRepository",{useClass:u.default}),t.suggestionsQueryService=f.container.resolve("suggestionsQueryService"),t.suggestionsRepository=f.container.resolve("suggestionsRepository"),t.suggestionsCommentsRepository=f.container.resolve("suggestionsCommentsRepository"),f.container.register("projectsRepository",{useClass:y.default}),f.container.register("projectsQueryService",{useClass:_.default}),t.projectsRepository=f.container.resolve("projectsRepository"),t.projectsQueryService=f.container.resolve("projectsQueryService"),f.container.register("projectsMembersRepository",{useClass:v.default}),f.container.register("projectsMembersQueryService",{useClass:h.default}),f.container.register("projectMemberService",{useClass:p.default}),t.projectsMembersRepository=f.container.resolve("projectsMembersRepository"),t.projectsMembersQueryService=f.container.resolve("projectsMembersQueryService"),t.projectMemberService=f.container.resolve("projectMemberService"),f.container.register("rolesRepository",{useClass:b.default}),t.rolesRepository=f.container.resolve("rolesRepository"),f.container.register("tasksQueryService",{useClass:c.default}),f.container.register("tasksRepository",{useClass:l.default}),t.tasksQueryService=f.container.resolve("tasksQueryService"),t.tasksRepository=f.container.resolve("tasksRepository")},6536:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(7807)),a=i(r(8012)),s=i(r(7382)),c=r(6818),l=r(5955);t.default=function(){return{signup:function(e,t,r){return n(void 0,void 0,void 0,(function(){return o(this,(function(i){return n(void 0,void 0,void 0,(function(){var r,n,i,c,f,d;return o(this,(function(o){switch(o.label){case 0:return r=e.body,n=r.email,i=r.password,c=r.nickname,f=a.default.create(c),d=s.default.create(n,i),[4,l.authRepository.loginByEmail(d.email)];case 1:if(o.sent())throw new u.default("既に登録されているメールアドレスです");return[4,l.authRepository.signupByEmail(f,d)];case 2:return o.sent(),t.status(200).end(),[2]}}))})).catch(r),[2]}))}))},login:function(e,t){if(!e.user)throw new u.default("認証に失敗しました",401);var r=(0,c.signToken)(e.user);t.status(200).send({id:e.user.id,token:r})},githubCallback:function(e,t){if(!e.user)throw new u.default("認証に失敗しました",401);var r=(0,c.signToken)(e.user);t.cookie("token",r),t.redirect("http://localhost:3000/login")},verify:function(e,t){if(!e.user)throw new u.default("認証に失敗しました",401);t.status(200).send({id:e.user.id})}}}},3533:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){this._id=e,this._identifier=t,this._credential=r}return Object.defineProperty(e.prototype,"id",{get:function(){if(!this._id.isGenerated)throw new Error("IDが生成されていません");return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this._identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"credential",{get:function(){return this._credential},enumerable:!1,configurable:!0}),e.prototype.setId=function(t){return new e(t,this._identifier,this._credential)},e}();t.default=r},7382:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(3533)),a=i(r(332)),s=i(r(4970)),c=r(2701),l=function(e){function t(t,r){return e.call(this,c.NoneId.instance,t,r)||this}return o(t,e),t.create=function(e,r){var n=a.default.create(e),o=s.default.create(r);return new t(n.value,o.encrepted)},Object.defineProperty(t.prototype,"email",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"password",{get:function(){return this.credential},enumerable:!1,configurable:!0}),t}(u.default);t.default=l},332:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.create=function(e){if(!/^[a-zA-Z0-9_.+-]+@([a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]*\.)+[a-zA-Z]{2,}$/.test(e))throw new a.default("メールアドレスの形式を確認してください",400);return new t(e)},t}(u.default);t.default=s},8012:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.create=function(e){if(e.length<3||e.length>255)throw new a.default("ニックネームは3文字以上255文字以下で入力してください");return new t(e)},t}(u.default);t.default=s},4970:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=r(4482),c=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.create=function(e){if(e.length<5||e.length>255)throw new a.default("パスワードは5文字以上255文字以下で入力してください",400);return new t(e)},Object.defineProperty(t.prototype,"encrepted",{get:function(){return(0,s.hashSync)(this._value)},enumerable:!1,configurable:!0}),t}(u.default);t.default=c},5402:function(e,t,r){var n,o,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(r(3511)),c=a(r(7807)),l=r(7055),f=r(136),d=r(4253),p=r(6818),h=r(4482),v=r(5955);s.default.use(new l.Strategy({usernameField:"email",passwordField:"password",session:!1},(function(e,t,r){return i(void 0,void 0,void 0,(function(){var n,o;return u(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,v.authRepository.loginByEmail(e)];case 1:return(n=i.sent())&&(0,h.compareSync)(t,n.credential)?[2,r(null,{id:n.id.value})]:[2,r(new c.default("メールアドレスまたはパスワードが誤っています",401))];case 2:return o=i.sent(),[2,r(o)];case 3:return[2]}}))}))})));var _={jwtFromRequest:f.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:p.JWT_SECRET_KEY};s.default.use(new f.Strategy(_,(function(e,t){t(null,e)}))),s.default.use(new d.Strategy({clientID:null!==(n=process.env.GITHUB_CLIENT_ID)&&void 0!==n?n:"INVALID_CLIENT_ID",clientSecret:null!==(o=process.env.GITHUB_CLIENT_SECRET)&&void 0!==o?o:"INVALID_CLIENT_SECRET",callbackURL:"http://localhost:3001/api/v1/auth/github/callback"},(function(e,t,r,n){return i(void 0,void 0,void 0,(function(){var t,o;return u(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,v.authRepository.authByGithub(r.username,r.id,e)];case 1:return t=i.sent(),[2,n(null,{id:t.id.value})];case 2:return o=i.sent(),[2,n(o)];case 3:return[2]}}))}))}))),t.default=s.default},4784:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(3533)),a=r(2701),s=r(8203),c=function(){function e(){}return e.prototype.signupByEmail=function(e,t){return n(this,void 0,void 0,(function(){var r=this;return o(this,(function(i){switch(i.label){case 0:return[4,s.prisma.$transaction((function(i){return n(r,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return[4,i.users.create({data:{nickname:e.value}})];case 1:return r=n.sent(),[4,i.users_auths.create({data:{identity_type:"email",identifier:t.email,credential:t.password,users:{connect:{id:r.id}}}})];case 2:return n.sent(),[2]}}))}))}))];case 1:return i.sent(),[2]}}))}))},e.prototype.loginByEmail=function(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return[4,s.prisma.users_auths.findFirst({where:{identity_type:"email",identifier:e},include:{users:{select:{id:!0}}}})];case 1:return(t=r.sent())?[2,this.createAuthCredential(t.users.id,t.identifier,t.credential)]:[2,t]}}))}))},e.prototype.authByGithub=function(e,t,r){return n(this,void 0,void 0,(function(){var n,i,u;return o(this,(function(o){switch(o.label){case 0:return[4,s.prisma.users_auths.findFirst({where:{identity_type:"github",identifier:t},include:{users:{select:{id:!0}}}})];case 1:return(n=o.sent())?[4,s.prisma.users_auths.update({where:{id:n.id},data:{credential:r}})]:[3,3];case 2:return o.sent(),[2,this.createAuthCredential(n.users.id,n.identifier,r)];case 3:return[4,s.prisma.users.create({data:{nickname:e}})];case 4:return i=o.sent(),console.log(i),[4,s.prisma.users_auths.create({data:{identity_type:"github",identifier:t,credential:r,users:{connect:{id:i.id}}}})];case 5:return u=o.sent(),[2,this.createAuthCredential(i.id,u.identifier,u.credential)]}}))}))},e.prototype.createAuthCredential=function(e,t,r){var n=new a.GeneratedId(e);return new u.default(n,t,r)},e}();t.default=c},6335:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(7807)),a=r(5955),s=r(2701),c=r(2424),l=i(r(3472));t.default=function(){return{create:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,f,d,p,h,v,_;return o(this,(function(o){switch(o.label){case 0:if(r=null===(_=e.user)||void 0===_?void 0:_.id,n=e.params.projectId,i=e.body.name,!r)throw new u.default("認証に失敗しました",401);return f=new s.GeneratedId(r),d=s.GeneratedId.validate(Number(n)||-1),[4,a.projectMemberService.isExist(d,f)];case 1:if(!o.sent())throw new u.default("プロジェクトに参加していません",403);return[4,a.rolesRepository.fetchRoleId(d,f.value)];case 2:if(p=o.sent(),!(0,c.checkPermission)(p,"chat-room:create"))throw new u.default("チャットルームを作成する権限がありません",403);return h=l.default.create(d,i),[4,a.chatsRoomsRepository.create(h)];case 3:return v=o.sent(),t.status(200).send({id:v.id.value,name:v.name.value,createdAt:v.createdAt}),[2]}}))})).catch(r)},fetchList:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,c,l,f;return o(this,(function(o){switch(o.label){case 0:if(r=null===(f=e.user)||void 0===f?void 0:f.id,n=e.params.projectId,!r)throw new u.default("認証に失敗しました",401);return i=new s.GeneratedId(r),c=s.GeneratedId.validate(Number(n)||-1),[4,a.projectMemberService.isExist(c,i)];case 1:if(!o.sent())throw new u.default("プロジェクトに参加していません",403);return[4,a.chatsRoomsQueryService.fetchList(c)];case 2:return l=o.sent(),t.status(200).send({rooms:l.rooms}),[2]}}))})).catch(r)},fetchById:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,c,l,f,d,p;return o(this,(function(o){switch(o.label){case 0:if(r=null===(p=e.user)||void 0===p?void 0:p.id,n=e.params.projectId,i=e.params.roomId,!r)throw new u.default("認証に失敗しました",401);return c=new s.GeneratedId(r),l=s.GeneratedId.validate(Number(n)||-1),f=s.GeneratedId.validate(Number(i)||-1),[4,a.projectMemberService.isExist(l,c)];case 1:if(!o.sent())throw new u.default("プロジェクトに参加していません",403);return[4,a.chatsRoomsQueryService.fetchById(f)];case 2:return d=o.sent(),t.status(200).send(d.toObject),[2]}}))})).catch(r)},update:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,l,f,d,p,h,v,_,y;return o(this,(function(o){switch(o.label){case 0:if(r=null===(y=e.user)||void 0===y?void 0:y.id,n=e.params.projectId,i=e.params.roomId,l=e.body.name,!r)throw new u.default("認証に失敗しました",401);return f=new s.GeneratedId(r),d=s.GeneratedId.validate(Number(n)||-1),p=s.GeneratedId.validate(Number(i)||-1),[4,a.projectMemberService.isExist(d,f)];case 1:if(!o.sent())throw new u.default("プロジェクトに参加していません",403);return[4,a.rolesRepository.fetchRoleId(d,f.value)];case 2:if(h=o.sent(),!(0,c.checkPermission)(h,"chat-room:update"))throw new u.default("チャットルームを更新する権限がありません",403);return[4,a.chatsRoomsRepository.find(d,p)];case 3:return v=o.sent(),_=v.copyWith({name:l}),[4,a.chatsRoomsRepository.update(_)];case 4:return o.sent(),t.status(200).send({id:_.id.value,name:_.name.value,createdAt:_.createdAt}),[2]}}))})).catch(r)},remove:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,l,f,d,p,h;return o(this,(function(o){switch(o.label){case 0:if(r=null===(h=e.user)||void 0===h?void 0:h.id,n=e.params.projectId,i=e.params.roomId,!r)throw new u.default("認証に失敗しました",401);return l=new s.GeneratedId(r),f=s.GeneratedId.validate(Number(n)||-1),d=s.GeneratedId.validate(Number(i)||-1),[4,a.projectMemberService.isExist(f,l)];case 1:if(!o.sent())throw new u.default("プロジェクトに参加していません",403);return[4,a.rolesRepository.fetchRoleId(f,l.value)];case 2:if(p=o.sent(),!(0,c.checkPermission)(p,"chat-room:remove"))throw new u.default("チャットルームを削除する権限がありません",403);return[4,a.chatsRoomsRepository.remove(d)];case 3:return o.sent(),t.status(200).end(),[2]}}))})).catch(r)}}}},3472:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(7559)),i=r(2701),u=r(5747),a=function(){function e(e,t,r,n){this._id=e,this._projectId=t,this._name=r,this._createdAt=n}return e.create=function(t,r){var n=o.default.validate(r);return new e(i.NoneId.instance,t,n,(0,u.now)())},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectId",{get:function(){return this._projectId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),e.prototype.setId=function(t){return new e(t,this._projectId,this._name,this._createdAt)},e.prototype.copyWith=function(t){var r=t.name?o.default.validate(t.name):this._name;return new e(this._id,this._projectId,r,this._createdAt)},e}();t.default=a},7559:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)throw new a.default("ルーム名を入力してください",400);if(e.length>50)throw new a.default("ルーム名は50文字以内で入力してください",400);return new t(e)},t}(u.default);t.default=s},5294:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChatRoomDetailDTO=t.ChatRoomListDTO=void 0;var r=function(){function e(e){this._rooms=e,Object.freeze(this)}return Object.defineProperty(e.prototype,"rooms",{get:function(){return this._rooms},enumerable:!1,configurable:!0}),e}();t.ChatRoomListDTO=r;var n=function(){function e(e,t){this._id=e,this._name=t,Object.freeze(this)}return Object.defineProperty(e.prototype,"toObject",{get:function(){return{id:this._id,name:this._name}},enumerable:!1,configurable:!0}),e}();t.ChatRoomDetailDTO=n},7708:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(5294),a=r(8203),s=i(r(7807)),c=function(){function e(){}return e.prototype.fetchList=function(e){return n(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,a.prisma.chat_rooms.findMany({where:{project_id:e.value}})];case 1:return t=o.sent(),r=t.map((function(e){return{id:e.id,name:e.name}})),[2,new u.ChatRoomListDTO(r)];case 2:throw n=o.sent(),console.log(n),new s.default("チャットルームの取得に失敗しました");case 3:return[2]}}))}))},e.prototype.fetchById=function(e){return n(this,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a.prisma.chat_rooms.findFirst({where:{id:e.value}})];case 1:if(!(t=n.sent()))throw new s.default("チャットルームが見つかりません",404);return[2,new u.ChatRoomDetailDTO(t.id,t.name)];case 2:if(r=n.sent(),console.log(r),r instanceof s.default)throw r;throw new s.default("チャットルームの取得に失敗しました");case 3:return[2]}}))}))},e}();t.default=c},4735:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(3472)),a=i(r(7559)),s=r(2701),c=r(8203),l=i(r(7807)),f=function(){function e(){}return e.prototype.create=function(e){return n(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,c.prisma.chat_rooms.create({data:{project_id:e.projectId.value,name:e.name.value,created_at:e.createdAt}})];case 1:return t=o.sent(),r=new s.GeneratedId(t.id),[2,e.setId(r)];case 2:throw n=o.sent(),console.log(n),new l.default("チャットルームの追加に失敗しました");case 3:return[2]}}))}))},e.prototype.find=function(e,t){return n(this,void 0,void 0,(function(){var r,n,i;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,c.prisma.chat_rooms.findFirst({where:{id:t.value}})];case 1:if(!(r=o.sent()))throw new l.default("チャットルームが見つかりません",404);return n=new a.default(r.name),[2,new u.default(t,e,n,r.created_at)];case 2:throw i=o.sent(),console.log(i),new l.default("チャットルームの取得に失敗しました");case 3:return[2]}}))}))},e.prototype.update=function(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,c.prisma.chat_rooms.update({where:{id:e.id.value},data:{name:e.name.value}})];case 1:return r.sent(),[3,3];case 2:throw t=r.sent(),console.log(t),new l.default("チャットルームの更新に失敗しました");case 3:return[2]}}))}))},e.prototype.remove=function(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,c.prisma.chat_rooms.findFirst({where:{id:e.value}})];case 1:if(!r.sent())throw new l.default("チャットルームが見つかりません",404);return[4,c.prisma.chat_comments.deleteMany({where:{room_id:e.value}})];case 2:return r.sent(),[4,c.prisma.chat_rooms.delete({where:{id:e.value}})];case 3:return r.sent(),[3,5];case 4:throw t=r.sent(),console.log(t),new l.default("チャットルームの削除に失敗しました");case 5:return[2]}}))}))},e}();t.default=f},6397:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.on("connection",(function(t){var o,i;console.log("a user connected: ".concat(t.id)),t.on("join",(function(u){return r(void 0,void 0,void 0,(function(){return n(this,(function(r){try{console.log(u),o=u.userId,i=u.roomid,t.join(i),e.to(i).emit("init",{comments:[]})}catch(e){console.error(e),t.emit("error",{message:"ルームに参加できませんでした"})}return[2]}))}))})),t.on("comment",(function(u){return r(void 0,void 0,void 0,(function(){return n(this,(function(r){try{console.log("コメント保存"),console.log("userId: ".concat(o,", roomId: ").concat(i)),console.log("data: ".concat(u)),e.to(i).emit("comment",{})}catch(e){console.error(e),t.emit("error",{message:"コメントを保存できませんでした"})}return[2]}))}))}))}))}},3125:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(5955),a=i(r(8966)),s=r(2701),c=i(r(7807));t.default=function(){return{add:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,l,f,d,p,h,v,_;return o(this,(function(o){switch(o.label){case 0:if(r=null===(_=e.user)||void 0===_?void 0:_.id,n=e.params.projectId,i=e.params.suggestionId,l=e.body.content,!r)throw new c.default("認証に失敗しました",401);return f=new s.GeneratedId(r),d=s.GeneratedId.validate(Number(n)||-1),p=s.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(d,f)];case 1:if(!o.sent())throw new c.default("プロジェクトに参加していません",403);return h=a.default.create(p,f,l),[4,u.suggestionsCommentsRepository.add(h)];case 2:return v=o.sent(),t.status(200).send(v.toObject),[2]}}))})).catch(r)},fetchList:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,l,f,d,p;return o(this,(function(o){switch(o.label){case 0:if(r=null===(p=e.user)||void 0===p?void 0:p.id,n=e.params.projectId,i=e.params.suggestionId,!r)throw new c.default("認証に失敗しました",401);return a=new s.GeneratedId(r),l=s.GeneratedId.validate(Number(n)||-1),f=s.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(l,a)];case 1:if(!o.sent())throw new c.default("プロジェクトに参加していません",403);return[4,u.suggestionsCommentsRepository.fetchList(f)];case 2:return d=o.sent(),t.status(200).send({comments:d.map((function(e){return e.toObject}))}),[2]}}))})).catch(r)}}}},8966:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(7658)),i=r(3922),u=r(2701),a=r(5747),s=n(r(7807)),c=function(){function e(e,t,r,n,o){this._id=e,this._suggestionId=t,this._userId=r,this._content=n,this._createdAt=o}return e.create=function(t,r,n){return new e(u.NoneId.instance,t,r,o.default.validate(n),(0,a.now)())},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"suggestionId",{get:function(){return this._suggestionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),e.prototype.setId=function(t){return new e(t,this._suggestionId,this._userId,this._content,this._createdAt)},e.prototype.toDto=function(e){if(!this._id.isGenerated)throw new s.default("コメントのIDが設定されていません",500);return new i.SuggestionCommentDTO({id:this._id.value,user:{id:this._userId.value,name:e},content:this._content.value,createdAt:this._createdAt})},e}();t.default=c},7658:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)throw new a.default("コメントを入力してください",400);if(e.length>255)throw new a.default("コメントは255文字以内で入力してください",400);return new t(e)},t}(u.default);t.default=s},3922:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionCommentDTO=void 0;var r=function(){function e(e){this._value=e,Object.freeze(this)}return Object.defineProperty(e.prototype,"toObject",{get:function(){return{id:this._value.id,user:{id:this._value.user.id,name:this._value.user.name},content:this._value.content,createdAt:this._value.createdAt}},enumerable:!1,configurable:!0}),e}();t.SuggestionCommentDTO=r},7868:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(3922),a=r(2701),s=r(8203),c=i(r(7807)),l=function(){function e(){}return e.prototype.add=function(e){return n(this,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,s.prisma.feature_suggestions_comments.create({data:{suggestion_id:e.suggestionId.value,user_id:e.userId.value,content:e.content.value,created_at:e.createdAt},include:{users:!0}})];case 1:return t=n.sent(),r=new a.GeneratedId(t.id),[2,e.setId(r).toDto(t.users.nickname)];case 2:throw n.sent(),new c.default("コメントの追加に失敗しました");case 3:return[2]}}))}))},e.prototype.fetchList=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,s.prisma.feature_suggestions_comments.findMany({where:{suggestion_id:e.value},include:{users:!0},orderBy:{created_at:"desc"}})];case 1:return[2,t.sent().map((function(e){return new u.SuggestionCommentDTO({id:e.id,user:{id:e.user_id,name:e.users.nickname},content:e.content,createdAt:e.created_at})}))];case 2:throw t.sent(),new c.default("コメントの取得に失敗しました");case 3:return[2]}}))}))},e}();t.default=l},4778:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.add=function(e){return this._baseSerialize(e)},t.prototype.update=function(e){return this._baseSerialize(e)},t.prototype._baseSerialize=function(e){return{id:e.id.value,projectId:e.projectId.value,proposerId:e.proposerId.value,title:e.title.value,description:e.description.value,status:e.status,vendorApproval:e.vendorApproval,clientApproval:e.clientApproval}},t}(i(r(4527)).default);t.default=u},173:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(5955),a=i(r(1)),s=i(r(4778)),c=r(2701),l=i(r(7807)),f=r(2424);t.default=function(){var e=new s.default;return{add:function(t,r,i){n(void 0,void 0,void 0,(function(){var n,i,s,f,d,p,h,v,_,y;return o(this,(function(o){switch(o.label){case 0:if(n=null===(y=t.user)||void 0===y?void 0:y.id,i=t.params.projectId,s=t.body,f=s.title,d=s.description,!n)throw new l.default("認証に失敗しました",401);return p=new c.GeneratedId(n),h=c.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(h,p)];case 1:if(!o.sent())throw new l.default("プロジェクトに参加していません",403);return v=a.default.create(h,p,f,d),[4,u.suggestionsRepository.add(v)];case 2:return _=o.sent(),r.status(200).send(e.add(_)),[2]}}))})).catch(i)},fetchList:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,s,f;return o(this,(function(o){switch(o.label){case 0:if(r=null===(f=e.user)||void 0===f?void 0:f.id,n=e.params.projectId,!r)throw new l.default("認証に失敗しました",401);return i=new c.GeneratedId(r),a=c.GeneratedId.validate(Number(n)||-1),[4,u.projectMemberService.isExist(a,i)];case 1:if(!o.sent())throw new l.default("プロジェクトに参加していません",403);return[4,u.suggestionsQueryService.fetchList(a)];case 2:return s=o.sent(),t.status(200).send({suggestions:s.suggestions}),[2]}}))})).catch(r)},fetchById:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,s,f,d,p;return o(this,(function(o){switch(o.label){case 0:if(r=null===(p=e.user)||void 0===p?void 0:p.id,n=e.params.projectId,i=e.params.suggestionId,!r)throw new l.default("認証に失敗しました",401);return a=new c.GeneratedId(r),s=c.GeneratedId.validate(Number(n)||-1),f=c.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(s,a)];case 1:if(!o.sent())throw new l.default("プロジェクトに参加していません",403);return[4,u.suggestionsQueryService.fetchById(f,s)];case 2:return d=o.sent(),t.status(200).send(d.toObject),[2]}}))})).catch(r)},update:function(t,r,i){n(void 0,void 0,void 0,(function(){var n,i,a,s,d,p,h,v,_,y,b,w,m,g,j,I;return o(this,(function(o){switch(o.label){case 0:if(n=null===(I=t.user)||void 0===I?void 0:I.id,i=t.params.projectId,a=t.params.suggestionId,s=t.body,d=s.title,p=s.description,h=s.status,v=s.vendorApproval,_=s.clientApproval,!n)throw new l.default("認証に失敗しました",401);return y=new c.GeneratedId(n),b=c.GeneratedId.validate(Number(i)||-1),w=c.GeneratedId.validate(Number(a)||-1),[4,u.projectMemberService.isExist(b,y)];case 1:if(!o.sent())throw new l.default("プロジェクトに参加していません",403);return[4,u.suggestionsRepository.find(w,b)];case 2:return m=o.sent(),[4,u.rolesRepository.fetchRoleId(b,y.value)];case 3:if(g=o.sent(),!(0,f.checkPermission)(g,"feature-suggestion:update",{vendorApproval:v,clientApproval:_}))throw new l.default("機能提案を更新する権限がありません",403);return j=m.copyWith({title:d,description:p,status:h,vendorApproval:v,clientApproval:_}),[4,u.suggestionsRepository.update(j)];case 4:return o.sent(),r.status(200).send(e.update(j)),[2]}}))})).catch(i)},remove:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,s,f,d;return o(this,(function(o){switch(o.label){case 0:if(r=null===(d=e.user)||void 0===d?void 0:d.id,n=e.params.projectId,i=e.params.suggestionId,!r)throw new l.default("認証に失敗しました",401);return a=new c.GeneratedId(r),s=c.GeneratedId.validate(Number(n)||-1),f=c.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(s,a)];case 1:if(!o.sent())throw new l.default("プロジェクトに参加していません",403);return[4,u.suggestionsRepository.remove(f,s)];case 2:return o.sent(),t.status(200).end(),[2]}}))})).catch(r)}}}},1:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(4277)),i=n(r(1502)),u=r(2701),a=function(){function e(e,t,r,n,o,i,u,a){this._id=e,this._projectId=t,this._proposerId=r,this._title=n,this._description=o,this._status=i,this._vendorApproval=u,this._clientApproval=a}return e.create=function(t,r,n,a){var s=i.default.validate(n),c=o.default.validate(a);return new e(u.NoneId.instance,t,r,s,c,!1,!1,!1)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectId",{get:function(){return this._projectId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"proposerId",{get:function(){return this._proposerId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vendorApproval",{get:function(){return this._vendorApproval},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientApproval",{get:function(){return this._clientApproval},enumerable:!1,configurable:!0}),e.prototype.setId=function(t){return new e(t,this.projectId,this._proposerId,this._title,this._description,this._status,this._vendorApproval,this._clientApproval)},e.prototype.copyWith=function(t){var r=t.title?i.default.validate(t.title):this._title,n=void 0!==t.description?o.default.validate(t.description):this._description;return new e(this.id,this.projectId,this.proposerId,r,n,void 0!==t.status?t.status:this.status,void 0!==t.vendorApproval?t.vendorApproval:this.vendorApproval,void 0!==t.clientApproval?t.clientApproval:this.clientApproval)},e}();t.default=a},4277:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)return new t("");if(e.length>1e3)throw new a.default("提案概要は1000文字以内で入力してください",400);return new t(e)},t}(u.default);t.default=s},1502:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)throw new a.default("提案タイトルを入力してください",400);if(e.length>100)throw new a.default("提案のタイトルは100文字以内で入力してください",400);return new t(e)},t}(u.default);t.default=s},5422:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionDetailDTO=t.SuggestionListDTO=void 0;var r=function(){function e(e){this._suggestions=e,Object.freeze(this)}return Object.defineProperty(e.prototype,"suggestions",{get:function(){return this._suggestions},enumerable:!1,configurable:!0}),e}();t.SuggestionListDTO=r;var n=function(){function e(e,t,r,n,o,i,u){this._id=e,this._proposerId=t,this._title=r,this._description=n,this._status=o,this._vendorApproval=i,this._clientApproval=u,Object.freeze(this)}return Object.defineProperty(e.prototype,"toObject",{get:function(){return{id:this._id,proposerId:this._proposerId,title:this._title,description:this._description,status:this._status,vendorApproval:this._vendorApproval,clientApproval:this._clientApproval}},enumerable:!1,configurable:!0}),e}();t.SuggestionDetailDTO=n},5019:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(5422),a=r(8203),s=i(r(7807)),c=function(){function e(){}return e.prototype.fetchList=function(e){return n(this,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a.prisma.feature_suggestions.findMany({where:{project_id:e.value},orderBy:{id:"desc"}})];case 1:return t=n.sent(),r=t.map((function(e){return{id:e.id,title:e.title,status:e.status,vendorApproval:e.vendor_approval,clientApproval:e.client_approval}})),[2,new u.SuggestionListDTO(r)];case 2:throw n.sent(),new s.default("提案一覧の取得に失敗しました");case 3:return[2]}}))}))},e.prototype.fetchById=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,a.prisma.feature_suggestions.findFirst({where:{id:e.value,project_id:t.value}})];case 1:if(!(r=o.sent()))throw new s.default("提案が見つかりません",404);return[2,new u.SuggestionDetailDTO(r.id,r.proposer_id,r.title,r.description,r.status,r.vendor_approval,r.client_approval)];case 2:if((n=o.sent())instanceof a.PrismaClientKnownRequestError)throw new s.default("提案の取得に失敗しました");throw n;case 3:return[2]}}))}))},e}();t.default=c},9381:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(1)),a=i(r(4277)),s=i(r(1502)),c=r(2701),l=r(8203),f=i(r(7807)),d=function(){function e(){}return e.prototype.add=function(e){return n(this,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,l.prisma.feature_suggestions.create({data:{project_id:e.projectId.value,proposer_id:e.proposerId.value,title:e.title.value,description:e.description.value}})];case 1:return t=n.sent(),r=new c.GeneratedId(t.id),[2,e.setId(r)];case 2:throw n.sent(),new f.default("機能提案の追加に失敗しました");case 3:return[2]}}))}))},e.prototype.find=function(e,t){return n(this,void 0,void 0,(function(){var r,n,i,d,p;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,l.prisma.feature_suggestions.findFirst({where:{id:e.value,project_id:t.value}})];case 1:if(!(r=o.sent()))throw new f.default("機能提案が見つかりません",404);return n=new c.GeneratedId(r.proposer_id),i=new s.default(r.title),d=new a.default(r.description),[2,new u.default(e,t,n,i,d,r.status,r.vendor_approval,r.client_approval)];case 2:if((p=o.sent())instanceof l.PrismaClientKnownRequestError)throw new f.default("機能提案の取得に失敗しました");throw p;case 3:return[2]}}))}))},e.prototype.update=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,l.prisma.feature_suggestions.update({where:{id:e.id.value},data:{title:e.title.value,description:e.description.value,status:e.status,vendor_approval:e.vendorApproval,client_approval:e.clientApproval}})];case 1:return t.sent(),[3,3];case 2:throw t.sent(),new f.default("機能提案の更新に失敗しました");case 3:return[2]}}))}))},e.prototype.remove=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,l.prisma.feature_suggestions.findFirst({where:{id:e.value,project_id:t.value}})];case 1:if(!(r=o.sent()))throw new f.default("機能提案が見つかりません",404);return[4,l.prisma.feature_suggestions.delete({where:{id:r.id}})];case 2:return o.sent(),[3,4];case 3:if((n=o.sent())instanceof l.PrismaClientKnownRequestError)throw new f.default("機能提案の削除に失敗しました");throw n;case 4:return[2]}}))}))},e}();t.default=d},6729:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(7807)),a=i(r(4021)),s=r(5955),c=r(2701),l=r(2424);t.default=function(){return{add:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,f,d,p,h,v,_,y,b;return o(this,(function(o){switch(o.label){case 0:if(r=null===(b=e.user)||void 0===b?void 0:b.id,n=e.params.projectId,i=e.body,f=i.roleId,d=i.userId,!r)throw new u.default("認証に失敗しました",401);if(p=c.GeneratedId.validate(Number(n)||-1),h=c.GeneratedId.validate(Number(d)||-1),!(v=(0,l.getRole)(Number(f)||-1)))throw new u.default("追加するメンバーに付与する権限が不正です",400);return[4,s.rolesRepository.fetchRoleId(p,r)];case 1:if(_=o.sent(),!(0,l.checkPermission)(_,"member:add",{targetRoleId:v.id}))throw new u.default("メンバーを追加する権限がありません",403);return[4,s.projectMemberService.isExist(p,h)];case 2:if(o.sent())throw new u.default("すでにプロジェクトに参加しています",400);return[4,s.projectMemberService.isMaxMember(p)];case 3:if(o.sent())throw new u.default("メンバー数が上限に達しています",400);return y=new a.default(p,h,v),[4,s.projectsMembersRepository.add(y)];case 4:return o.sent(),t.status(200).send({userId:y.userId.value,role:{id:y.role.id,name:y.role.name}}),[2]}}))})).catch(r)},fetchList:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,f,d;return o(this,(function(o){switch(o.label){case 0:if(r=null===(d=e.user)||void 0===d?void 0:d.id,n=e.params.projectId,!r)throw new u.default("認証に失敗しました",401);return i=c.GeneratedId.validate(Number(n)||-1),[4,s.rolesRepository.fetchRoleId(i,r)];case 1:if(a=o.sent(),!(0,l.checkPermission)(a,"member:read"))throw new u.default("メンバー一覧を取得する権限がありません",403);return[4,s.projectsMembersQueryService.fetchList(i)];case 2:return f=o.sent(),t.status(200).send({members:f.members}),[2]}}))})).catch(r)},update:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,f,d,p,h,v,_,y,b,w,m;return o(this,(function(o){switch(o.label){case 0:if(r=null===(m=e.user)||void 0===m?void 0:m.id,n=e.params.projectId,i=e.params.userId,f=e.body.roleId,!r)throw new u.default("認証に失敗しました",401);if(d=c.GeneratedId.validate(Number(n)||-1),p=c.GeneratedId.validate(Number(i)||-1),!(h=(0,l.getRole)(Number(f)||-1)))throw new u.default("更新するメンバーに付与する権限が不正です",400);return[4,s.rolesRepository.fetchRoleList(d)];case 1:if(v=o.sent(),_=v.getRole(r),!(0,l.checkPermission)(_,"member:update",{targetRoleId:h.id}))throw new u.default("メンバーを更新する権限がありません",403);return[4,s.projectMemberService.isExist(d,p)];case 2:if(!o.sent())throw new u.default("プロジェクトに参加していません",403);if(y=v.getRole(p.value),!(b=(0,l.getRole)(y)))throw new u.default("更新するメンバーの権限が見つかりませんでした",404);if(b===l.ROLE_LIST.ADMINISTRATOR)throw new u.default("管理者を別の権限に変更することはできません",400);return w=new a.default(d,p,h),[4,s.projectsMembersRepository.update(w)];case 3:return o.sent(),t.status(200).send(),[2]}}))})).catch(r)},remove:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,f,d,p,h,v;return o(this,(function(o){switch(o.label){case 0:if(r=null===(v=e.user)||void 0===v?void 0:v.id,n=e.params.projectId,i=e.params.userId,!r)throw new u.default("認証に失敗しました",401);if(a=c.GeneratedId.validate(Number(i)||-1),new c.GeneratedId(r).equals(a))throw new u.default("自分を削除することはできません",400);return f=c.GeneratedId.validate(Number(n)||-1),[4,s.rolesRepository.fetchRoleList(f)];case 1:if(d=o.sent(),p=d.getRole(r),h=d.getRole(a.value),!(0,l.checkPermission)(p,"member:remove",{targetRoleId:h}))throw new u.default("メンバーを削除する権限がありません",403);return[4,s.projectsMembersRepository.remove(f,a)];case 2:return o.sent(),t.status(200).end(),[2]}}))})).catch(r)}}}},4021:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){this._projectId=e,this._userId=t,this._role=r}return Object.defineProperty(e.prototype,"projectId",{get:function(){return this._projectId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"role",{get:function(){return this._role},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return this.projectId.equals(e.projectId)&&this.userId.equals(e.userId)},e}();t.default=r},9985:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,u=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(u=(i<3?o(u):i>3?o(t,r,u):o(t,r))||u);return i>3&&u&&Object.defineProperty(t,r,u),u},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}},u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(6896),c=function(){function e(e){this.MAX_MEMBER_LENGTH=30,this.queryService=e}return e.prototype.isExist=function(e,t){return u(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.queryService.find(e,t)]}))}))},e.prototype.isMaxMember=function(e){return u(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.queryService.count(e)];case 1:return[2,t.sent()>=this.MAX_MEMBER_LENGTH]}}))}))},n([(0,s.injectable)(),i(0,(0,s.inject)("projectsMembersQueryService")),o("design:paramtypes",[Object])],e)}();t.default=c},3388:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MemberListDTO=void 0;var r=function(){function e(e){this._members=e,Object.freeze(this)}return Object.defineProperty(e.prototype,"members",{get:function(){return this._members},enumerable:!1,configurable:!0}),e}();t.MemberListDTO=r},5610:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(8203),a=r(3388),s=i(r(7807)),c=function(){function e(){}return e.prototype.fetchList=function(e){return n(this,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return[4,u.prisma.projects.findFirst({where:{id:e.value,delete_flag:!1},include:{projects_members:{where:{delete_flag:!1},include:{users:!0,roles:!0},orderBy:{roles:{weight:"asc"}}}}})];case 1:if(!(t=n.sent()))throw new s.default("プロジェクトが存在しません",404);return r=t.projects_members.map((function(e){return{userId:e.user_id,name:e.users.nickname,role:{id:e.roles.id,name:e.roles.name}}})),[2,new a.MemberListDTO(r)]}}))}))},e.prototype.find=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,u.prisma.projects_members.findFirst({where:{project_id:e.value,user_id:t.value,delete_flag:!1}})];case 1:return r.sent()?[2,!0]:[2,!1]}}))}))},e.prototype.count=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,u.prisma.projects_members.count({where:{project_id:e.value,delete_flag:!1}})];case 1:return[2,t.sent()]}}))}))},e}();t.default=c},8611:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(8203),a=i(r(7807)),s=function(){function e(){}return e.prototype.add=function(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,u.prisma.projects_members.upsert({where:{project_id_user_id:{project_id:e.projectId.value,user_id:e.userId.value}},update:{delete_flag:!1},create:{project_id:e.projectId.value,user_id:e.userId.value,role_id:e.role.id}})];case 1:return r.sent(),[3,3];case 2:if((t=r.sent())instanceof u.PrismaClientKnownRequestError&&"P2003"===t.code)throw new a.default("そのユーザーは存在しません",400);throw new a.default("プロジェクトメンバーの追加に失敗しました");case 3:return[2]}}))}))},e.prototype.update=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,u.prisma.projects_members.update({where:{project_id_user_id:{project_id:e.projectId.value,user_id:e.userId.value}},data:{role_id:e.role.id}})];case 1:return t.sent(),[2]}}))}))},e.prototype.remove=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,u.prisma.projects_members.update({where:{project_id_user_id:{project_id:e.value,user_id:t.value}},data:{delete_flag:!0}})];case 1:return r.sent(),[2]}}))}))},e}();t.default=s},290:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(7807)),a=i(r(3964)),s=i(r(8462)),c=r(2701),l=r(5955),f=r(2424);t.default=function(){return{create:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,s,f,d,p;return o(this,(function(o){switch(o.label){case 0:if(r=null===(p=e.user)||void 0===p?void 0:p.id,n=e.body,i=n.name,s=n.description,!r)throw new u.default("認証に失敗しました",401);return f=a.default.create(new c.GeneratedId(r),i,s),[4,l.projectsRepository.create(f)];case 1:return d=o.sent(),t.status(200).send({id:d.detail.id.value,name:d.detail.name.value,description:d.detail.description.value}),[2]}}))})).catch(r)},fetchById:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,s;return o(this,(function(o){switch(o.label){case 0:if(r=e.params.id,!(n=null===(s=e.user)||void 0===s?void 0:s.id))throw new u.default("認証に失敗しました",401);return i=c.GeneratedId.validate(Number(r)||-1),[4,l.projectsQueryService.fetchById(i.value,n)];case 1:return a=o.sent(),t.status(200).send({id:a.id,name:a.name,description:a.description,roleId:a.roleId}),[2]}}))})).catch(r)},fetchList:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i;return o(this,(function(o){switch(o.label){case 0:if(!(r=null===(i=e.user)||void 0===i?void 0:i.id))throw new u.default("認証に失敗しました",401);return[4,l.projectsQueryService.fetchList(r)];case 1:return n=o.sent(),t.status(200).send({projects:n.map((function(e){return{id:e.id,name:e.name,description:e.description}}))}),[2]}}))})).catch(r)},update:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,d,p,h,v,_,y;return o(this,(function(o){switch(o.label){case 0:if(r=e.params.id,n=null===(y=e.user)||void 0===y?void 0:y.id,i=e.body,a=i.name,d=i.description,!n)throw new u.default("認証に失敗しました",401);return p=c.GeneratedId.validate(Number(r)||-1),[4,l.rolesRepository.fetchRoleId(p,n)];case 1:if(h=o.sent(),!(0,f.checkPermission)(h,"project:update"))throw new u.default("プロジェクトを更新する権限がありません",403);return v=s.default.create(a,d),_=v.setId(p),[4,l.projectsRepository.update(_)];case 2:return o.sent(),t.status(200).send({id:_.id.value,name:_.name.value,description:_.description.value}),[2]}}))})).catch(r)},remove:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,s;return o(this,(function(o){switch(o.label){case 0:if(r=e.params.id,!(n=null===(s=e.user)||void 0===s?void 0:s.id))throw new u.default("認証に失敗しました",401);return i=c.GeneratedId.validate(Number(r)||-1),[4,l.rolesRepository.fetchRoleId(i,n)];case 1:if(a=o.sent(),!(0,f.checkPermission)(a,"project:remove"))throw new u.default("プロジェクトを削除する権限がありません",403);return[4,l.projectsRepository.remove(i)];case 2:return o.sent(),t.status(200).end(),[2]}}))})).catch(r)}}}},3964:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(8462)),i=function(){function e(e,t){this._ownerId=e,this._detail=t}return e.create=function(t,r,n){return new e(t,o.default.create(r,n))},Object.defineProperty(e.prototype,"detail",{get:function(){return this._detail},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownerId",{get:function(){return this._ownerId},enumerable:!1,configurable:!0}),e.prototype.setId=function(t){var r=this._detail.setId(t);return new e(this._ownerId,r)},e}();t.default=i},8462:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1179)),i=n(r(1090)),u=r(2701),a=function(){function e(e,t,r){this._id=e,this._name=t,this._description=r}return e.create=function(t,r){return new e(u.NoneId.instance,i.default.create(t),o.default.create(r))},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),e.prototype.setId=function(t){return new e(t,this._name,this._description)},e}();t.default=a},1179:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.create=function(e){if(!e)return new t("");if(e.length>255)throw new a.default("プロジェクトの説明は255文字以下で入力してください",400);return new t(e)},t}(u.default);t.default=s},1090:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.create=function(e){if(!e)throw new a.default("プロジェクト名を入力してください",400);if(e.length<3||e.length>255)throw new a.default("プロジェクト名は3文字以上255文字以下で入力してください",400);return new t(e)},t}(u.default);t.default=s},2343:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectListItemDTO=t.ProjectDTO=void 0;var r=function(){function e(e,t,r,n){this._id=e,this._name=t,this._description=r,this._roleId=n,Object.freeze(this)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roleId",{get:function(){return this._roleId},enumerable:!1,configurable:!0}),e}();t.ProjectDTO=r;var n=function(){function e(e,t,r){this._id=e,this._name=t,this._description=r,Object.freeze(this)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),e}();t.ProjectListItemDTO=n},8540:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(7807)),a=r(8203),s=r(2343),c=function(){function e(){}return e.prototype.fetchList=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,a.prisma.projects.findMany({where:{delete_flag:!1,projects_members:{some:{user_id:e,delete_flag:!1}}},orderBy:{updated_at:"desc"}})];case 1:return[2,t.sent().map((function(e){return new s.ProjectListItemDTO(e.id,e.name,e.description)}))]}}))}))},e.prototype.fetchById=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return[4,a.prisma.projects.findFirst({where:{id:e,delete_flag:!1},include:{projects_members:{where:{user_id:t,delete_flag:!1},take:1}}})];case 1:if(!(r=o.sent()))throw new u.default("プロジェクトが存在しません",404);if(!(n=r.projects_members[0]))throw new u.default("プロジェクトに参加していません",400);return[2,new s.ProjectDTO(r.id,r.name,r.description,n.role_id)]}}))}))},e}();t.default=c},1195:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(2701),u=r(8203),a=r(5747),s=r(2424),c=function(){function e(){}return e.prototype.create=function(e){return n(this,void 0,void 0,(function(){var t,r,c=this;return o(this,(function(l){switch(l.label){case 0:return[4,u.prisma.$transaction((function(t){return n(c,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,t.projects.create({data:{name:e.detail.name.value,description:e.detail.description.value,updated_at:(0,a.now)(),projects_members:{create:{user_id:e.ownerId.value,role_id:s.ROLE_LIST.ADMINISTRATOR.id}}}})];case 1:return[2,r.sent()]}}))}))}))];case 1:return t=l.sent(),r=new i.GeneratedId(t.id),[2,e.setId(r)]}}))}))},e.prototype.update=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,u.prisma.projects.update({where:{id:e.id.value},data:{name:e.name.value,description:e.description.value,updated_at:(0,a.now)()}})];case 1:return t.sent(),[2]}}))}))},e.prototype.remove=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,u.prisma.projects.update({where:{id:e.value},data:{delete_flag:!0}})];case 1:return t.sent(),[2]}}))}))},e}();t.default=c},3711:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectMemberRoleList=void 0;var o=n(r(7807)),i=function(){function e(e){this._roles=e,Object.freeze(this)}return Object.defineProperty(e.prototype,"roles",{get:function(){return this._roles},enumerable:!1,configurable:!0}),e.prototype.getRole=function(e){var t=this._roles.find((function(t){return t.userId===e}));if(!t)throw new o.default("プロジェクトに参加していません",403);return t.roleId},e}();t.ProjectMemberRoleList=i},2886:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(7807)),a=r(8203),s=r(3711),c=function(){function e(){}return e.prototype.fetchRoleId=function(e,t){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return[4,a.prisma.projects.findFirst({where:{id:e.value,delete_flag:!1}})];case 1:if(!n.sent())throw new u.default("プロジェクトが存在しません",404);return[4,a.prisma.projects_members.findFirst({where:{project_id:e.value,user_id:t,delete_flag:!1}})];case 2:if(!(r=n.sent()))throw new u.default("プロジェクトに参加していません",403);return[2,r.role_id]}}))}))},e.prototype.fetchRoleList=function(e){return n(this,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return[4,a.prisma.projects.findFirst({where:{id:e.value,delete_flag:!1}})];case 1:if(!n.sent())throw new u.default("プロジェクトが存在しません",404);return[4,a.prisma.projects_members.findMany({where:{project_id:e.value,delete_flag:!1}})];case 2:return t=n.sent(),r=t.map((function(e){return{userId:e.user_id,roleId:e.role_id}})),[2,new s.ProjectMemberRoleList(r)]}}))}))},e}();t.default=c},8332:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=r(5955),a=i(r(552)),s=r(2701),c=i(r(7807));t.default=function(){return{add:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,l,f,d,p,h,v,_,y,b,w;return o(this,(function(o){switch(o.label){case 0:if(r=null===(w=e.user)||void 0===w?void 0:w.id,n=e.params.projectId,i=e.body,l=i.title,f=i.description,d=i.status,p=i.due,h=i.priority,!r)throw new c.default("認証に失敗しました",401);return v=new s.GeneratedId(r),_=s.GeneratedId.validate(Number(n)||-1),[4,u.projectMemberService.isExist(_,v)];case 1:if(!o.sent())throw new c.default("プロジェクトに参加していません",403);return y=a.default.create(_,l,f,d,p,h),[4,u.tasksRepository.add(y)];case 2:return b=o.sent(),t.status(200).send({id:b.id.value,title:b.title.value,description:b.description.value,status:b.status.value,due:b.due,priority:b.priority.value}),[2]}}))})).catch(r)},fetchList:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,l,f;return o(this,(function(o){switch(o.label){case 0:if(r=null===(f=e.user)||void 0===f?void 0:f.id,n=e.params.projectId,!r)throw new c.default("認証に失敗しました",401);return i=new s.GeneratedId(r),a=s.GeneratedId.validate(Number(n)||-1),[4,u.projectMemberService.isExist(a,i)];case 1:if(!o.sent())throw new c.default("プロジェクトに参加していません",403);return[4,u.tasksQueryService.fetchList(a)];case 2:return l=o.sent(),t.status(200).send({tasks:l.tasks}),[2]}}))})).catch(r)},fetchById:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,l,f,d,p;return o(this,(function(o){switch(o.label){case 0:if(r=null===(p=e.user)||void 0===p?void 0:p.id,n=e.params.projectId,i=e.params.taskId,!r)throw new c.default("認証に失敗しました",401);return a=new s.GeneratedId(r),l=s.GeneratedId.validate(Number(n)||-1),f=s.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(l,a)];case 1:if(!o.sent())throw new c.default("プロジェクトに参加していません",403);return[4,u.tasksQueryService.fetchById(l,f)];case 2:return d=o.sent(),t.status(200).send(d.toObject),[2]}}))})).catch(r)},update:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,l,f,d,p,h,v,_,y,b,w,m;return o(this,(function(o){switch(o.label){case 0:if(r=null===(m=e.user)||void 0===m?void 0:m.id,n=e.params.projectId,i=e.params.taskId,a=e.body,l=a.title,f=a.description,d=a.status,p=a.due,h=a.priority,!r)throw new c.default("認証に失敗しました",401);return v=new s.GeneratedId(r),_=s.GeneratedId.validate(Number(n)||-1),y=s.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(_,v)];case 1:if(!o.sent())throw new c.default("プロジェクトに参加していません",403);return[4,u.tasksRepository.find(_,y)];case 2:return b=o.sent(),w=b.copyWith({title:l,description:f,status:d,due:p,priority:h}),[4,u.tasksRepository.update(w)];case 3:return o.sent(),t.status(200).send({id:w.id.value,title:w.title.value,description:w.description.value,status:w.status.value,due:w.due,priority:w.priority.value}),[2]}}))})).catch(r)},remove:function(e,t,r){n(void 0,void 0,void 0,(function(){var r,n,i,a,l,f,d;return o(this,(function(o){switch(o.label){case 0:if(r=null===(d=e.user)||void 0===d?void 0:d.id,n=e.params.projectId,i=e.params.taskId,!r)throw new c.default("認証に失敗しました",401);return a=new s.GeneratedId(r),l=s.GeneratedId.validate(Number(n)||-1),f=s.GeneratedId.validate(Number(i)||-1),[4,u.projectMemberService.isExist(l,a)];case 1:if(!o.sent())throw new c.default("プロジェクトに参加していません",403);return[4,u.tasksRepository.remove(l,f)];case 2:return o.sent(),t.status(200).end(),[2]}}))})).catch(r)}}}},552:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1022)),i=n(r(8852)),u=n(r(8902)),a=n(r(664)),s=r(2701),c=function(){function e(e,t,r,n,o,i,u){this._id=e,this._projectId=t,this._title=r,this._description=n,this._status=o,this._due=i,this._priority=u}return e.create=function(t,r,n,c,l,f){var d=a.default.validate(r),p=o.default.validate(n),h=u.default.validate(c),v=new Date(l),_=i.default.validate(f);return new e(s.NoneId.instance,t,d,p,h,v,_)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectId",{get:function(){return this._projectId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"due",{get:function(){return this._due},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),e.prototype.setId=function(t){return new e(t,this._projectId,this._title,this._description,this._status,this._due,this._priority)},e.prototype.copyWith=function(t){var r=t.title?a.default.validate(t.title):this._title,n=t.description?o.default.validate(t.description):this._description,s=t.status?u.default.validate(t.status):this._status,c=t.due?new Date(t.due):this._due,l=t.priority?i.default.validate(t.priority):this._priority;return new e(this._id,this._projectId,r,n,s,c,l)},e}();t.default=c},1022:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)return new t("");if(e.length>500)throw new a.default("タスクの説明は500文字以内で入力してください",400);return new t(e)},t}(u.default);t.default=s},8852:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=["設定なし","低","中","高"],c=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)return new t(s[0]);if(!s.includes(e))throw new a.default("タスク優先度が不正です",400);return new t(e)},t.getPriority=function(e){return s.find((function(t){return t===e}))||s[0]},t}(u.default);t.default=c},8902:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=["未着手","進行中","完了済み"],c=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)return new t(s[0]);if(!s.includes(e))throw new a.default("タスクステータスが不正です",400);return new t(e)},t.getStatus=function(e){return s.find((function(t){return t===e}))||s[0]},t}(u.default);t.default=c},664:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(9596)),a=i(r(7807)),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.validate=function(e){if(!e)throw new a.default("タスク名を入力してください",400);if(e.length>100)throw new a.default("タスク名は100文字以内で入力してください",400);return new t(e)},t}(u.default);t.default=s},7799:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TaskDetailDTO=t.TaskListDTO=void 0;var r=function(){function e(e){this._tasks=e,Object.freeze(this)}return Object.defineProperty(e.prototype,"tasks",{get:function(){return this._tasks},enumerable:!1,configurable:!0}),e}();t.TaskListDTO=r;var n=function(){function e(e,t,r,n,o,i){this._id=e,this._title=t,this._description=r,this._status=n,this._due=o,this._priority=i,Object.freeze(this)}return Object.defineProperty(e.prototype,"toObject",{get:function(){return{id:this._id,title:this._title,description:this._description,status:this._status,due:this._due,priority:this._priority}},enumerable:!1,configurable:!0}),e}();t.TaskDetailDTO=n},4250:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(8852)),a=i(r(8902)),s=r(7799),c=r(8203),l=i(r(7807)),f=function(){function e(){}return e.prototype.fetchList=function(e){return n(this,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c.prisma.tasks.findMany({where:{project_id:e.value}})];case 1:return t=n.sent(),r=t.map((function(e){return{id:e.id,title:e.title,status:a.default.getStatus(e.status)}})),[2,new s.TaskListDTO(r)];case 2:throw n.sent(),new l.default("タスク一覧の取得に失敗しました");case 3:return[2]}}))}))},e.prototype.fetchById=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,c.prisma.tasks.findFirst({where:{project_id:e.value,id:t.value}})];case 1:if(!(r=o.sent()))throw new l.default("タスクが見つかりません",404);return[2,new s.TaskDetailDTO(r.id,r.title,r.description,a.default.getStatus(r.status),r.due,u.default.getPriority(r.priority))];case 2:if(n=o.sent(),console.log(n),n instanceof l.default)throw n;throw new l.default("タスクの取得に失敗しました");case 3:return[2]}}))}))},e}();t.default=f},2381:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(r(552)),a=i(r(1022)),s=i(r(8852)),c=i(r(8902)),l=i(r(664)),f=r(2701),d=r(8203),p=i(r(7807)),h=function(){function e(){}return e.prototype.add=function(e){return n(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,d.prisma.tasks.create({data:{project_id:e.projectId.value,title:e.title.value,description:e.description.value,status:e.status.value,due:e.due,priority:e.priority.value}})];case 1:return t=o.sent(),r=new f.GeneratedId(t.id),[2,e.setId(r)];case 2:throw n=o.sent(),console.log(n),new p.default("タスクの追加に失敗しました");case 3:return[2]}}))}))},e.prototype.find=function(e,t){return n(this,void 0,void 0,(function(){var r,n,i,f,h,v;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,d.prisma.tasks.findFirst({where:{id:t.value,project_id:e.value}})];case 1:if(!(r=o.sent()))throw new p.default("タスクが見つかりません",404);return n=new l.default(r.title),i=new a.default(r.description),f=new c.default(r.status),h=new s.default(r.priority),[2,new u.default(t,e,n,i,f,r.due,h)];case 2:if((v=o.sent())instanceof d.PrismaClientKnownRequestError)throw new p.default("タスクの取得に失敗しました");throw v;case 3:return[2]}}))}))},e.prototype.update=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,d.prisma.tasks.update({where:{id:e.id.value},data:{title:e.title.value,description:e.description.value,status:e.status.value,due:e.due,priority:e.priority.value}})];case 1:return t.sent(),[3,3];case 2:throw t.sent(),new p.default("タスクの更新に失敗しました");case 3:return[2]}}))}))},e.prototype.remove=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,d.prisma.tasks.findFirst({where:{id:t.value,project_id:e.value}})];case 1:if(!(r=o.sent()))throw new p.default("タスクが見つかりません",404);return[4,d.prisma.tasks.delete({where:{id:r.id}})];case 2:return o.sent(),[3,4];case 3:if((n=o.sent())instanceof d.PrismaClientKnownRequestError)throw new p.default("タスクの削除に失敗しました");throw n;case 4:return[2]}}))}))},e}();t.default=h},2701:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NoneId=t.GeneratedId=void 0;var o=n(r(7807)),i=function(){function e(e){this.isGenerated=!0,this._value=e,Object.freeze(this)}return e.validate=function(t){if(t<1||!Number.isInteger(t))throw new o.default("IDは1以上の整数で入力してください",400);return new e(t)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return this.value===e.value},e}();t.GeneratedId=i;var u=function(){function e(){this.isGenerated=!1}return Object.defineProperty(e.prototype,"value",{get:function(){throw new o.default("IDが生成されていません",400)},enumerable:!1,configurable:!0}),e.instance=new e,e}();t.NoneId=u},9596:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._value=e,Object.freeze(this)}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return this.constructor.name===e.constructor.name&&this._value===e.value},e}();t.default=r},8203:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.prisma=t.PrismaClientKnownRequestError=void 0;var n=r(3524),o=r(5423);Object.defineProperty(t,"PrismaClientKnownRequestError",{enumerable:!0,get:function(){return o.PrismaClientKnownRequestError}}),t.prisma=new n.PrismaClient},9039:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(3236);var o=n(r(7280)),i=r(1055),u=o.default.server.port;i.listen(u,(function(){console.log("Server listening on port ".concat(u))}))},5635:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(4527)),i=n(r(565));t.default=function(e){e.use((function(e,t,r,n){var u=e.status||500,a=new o.default;i.default.error(e.message),r.status(u).send(a.error(e))}))}},2919:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.authRouter=void 0;var o=n(r(5402)),i=n(r(6536));t.authRouter=function(e){var t=e.Router(),r=(0,i.default)();return t.post("/auth/signup",r.signup),t.post("/auth/login",o.default.authenticate("local",{session:!1,scope:["user:email"]}),r.login),t.get("/auth/github",o.default.authenticate("github",{session:!1})),t.get("/auth/github/callback",o.default.authenticate("github",{session:!1}),r.githubCallback),t.post("/auth/verify",o.default.authenticate("jwt",{session:!1}),r.verify),t}},1106:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.chatRouter=void 0;var o=n(r(6335)),i=n(r(5402)),u="/chats/rooms";t.chatRouter=function(e){var t=e.Router({mergeParams:!0}),r={rooms:(0,o.default)()};return t.route("".concat(u)).post(i.default.authenticate("jwt",{session:!1}),r.rooms.create).get(i.default.authenticate("jwt",{session:!1}),r.rooms.fetchList),t.route("".concat(u,"/:roomId")).get(i.default.authenticate("jwt",{session:!1}),r.rooms.fetchById).put(i.default.authenticate("jwt",{session:!1}),r.rooms.update).delete(i.default.authenticate("jwt",{session:!1}),r.rooms.remove),t},t.default=t.chatRouter},7464:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.featureSuggestionRouter=void 0;var o=n(r(5402)),i=n(r(173)),u=n(r(3125)),a="/feature-suggestions";t.featureSuggestionRouter=function(e){var t=e.Router({mergeParams:!0}),r={suggestion:(0,i.default)(),comment:(0,u.default)()};return t.route(a).post(o.default.authenticate("jwt",{session:!1}),r.suggestion.add).get(o.default.authenticate("jwt",{session:!1}),r.suggestion.fetchList),t.route("".concat(a,"/:suggestionId")).get(o.default.authenticate("jwt",{session:!1}),r.suggestion.fetchById).put(o.default.authenticate("jwt",{session:!1}),r.suggestion.update).delete(o.default.authenticate("jwt",{session:!1}),r.suggestion.remove),t.route("".concat(a,"/:suggestionId/comments")).get(o.default.authenticate("jwt",{session:!1}),r.comment.fetchList).post(o.default.authenticate("jwt",{session:!1}),r.comment.add),t},t.default=t.featureSuggestionRouter},9736:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(2919),t),o(r(1106),t),o(r(7464),t),o(r(9413),t),o(r(1407),t),o(r(2693),t)},9413:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.projectRouter=void 0;var o=n(r(5402)),i=n(r(290));t.projectRouter=function(e){var t=e.Router(),r=(0,i.default)();return t.route("/").get(o.default.authenticate("jwt",{session:!1}),r.fetchList).post(o.default.authenticate("jwt",{session:!1}),r.create),t.route("/:id").get(o.default.authenticate("jwt",{session:!1}),r.fetchById).put(o.default.authenticate("jwt",{session:!1}),r.update).delete(o.default.authenticate("jwt",{session:!1}),r.remove),t}},1407:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.projectMemberRouter=void 0;var o=n(r(5402)),i=n(r(6729));t.projectMemberRouter=function(e){var t=e.Router({mergeParams:!0}),r=(0,i.default)();return t.route("/members").post(o.default.authenticate("jwt",{session:!1}),r.add).get(o.default.authenticate("jwt",{session:!1}),r.fetchList),t.route("/members/:userId").put(o.default.authenticate("jwt",{session:!1}),r.update).delete(o.default.authenticate("jwt",{session:!1}),r.remove),t},t.default=t.projectMemberRouter},2693:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.taskRouter=void 0;var o=n(r(8332)),i=n(r(5402)),u="/tasks";t.taskRouter=function(e){var t=e.Router({mergeParams:!0}),r=(0,o.default)();return t.route("".concat(u)).post(i.default.authenticate("jwt",{session:!1}),r.add).get(i.default.authenticate("jwt",{session:!1}),r.fetchList),t.route("".concat(u,"/:taskId")).get(i.default.authenticate("jwt",{session:!1}),r.fetchById).put(i.default.authenticate("jwt",{session:!1}),r.update).delete(i.default.authenticate("jwt",{session:!1}),r.remove),t},t.default=t.taskRouter},1055:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(3582)),i=n(r(3685)),u=n(r(6860)),a=n(r(7280)),s=n(r(5635)),c=n(r(5402)),l=r(9736),f=r(3952),d=n(r(6397)),p=(0,u.default)(),h=i.default.createServer(p);p.use(u.default.json()),p.use(u.default.urlencoded({extended:!1}));var v={origin:a.default.server.cors.origin,optionsSuccessStatus:200};p.use((0,o.default)(v)),p.use(c.default.initialize()),p.use("/api/v1",(0,l.authRouter)(u.default)),p.use("/api/v1/projects",(0,l.projectRouter)(u.default)),p.use("/api/v1/projects/:projectId",(0,l.chatRouter)(u.default),(0,l.featureSuggestionRouter)(u.default),(0,l.taskRouter)(u.default),(0,l.projectMemberRouter)(u.default));var _=new f.Server(h,{cors:{origin:a.default.server.cors.origin}});(0,d.default)(_),(0,s.default)(p),e.exports=h},5747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isInvalidDate=t.now=void 0,t.now=function(){return new Date((new Date).toLocaleString("ja-JP",{timeZone:"Asia/Tokyo"}))},t.isInvalidDate=function(e){return isNaN(e.getTime())}},7807:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){void 0===r&&(r=500);var n=e.call(this,t)||this;return n.message=t,n.status=r,n}return n(t,e),t}(Error);t.default=o},4482:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.compareSync=t.hashSync=void 0;var o=n(r(7096));t.hashSync=function(e){return o.default.hashSync(e,10)},t.compareSync=function(e,t){return o.default.compareSync(e,t)}},6818:function(e,t,r){var n,o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.signToken=t.JWT_SECRET_KEY=void 0;var i=o(r(9344));t.JWT_SECRET_KEY=null!==(n=process.env.JWT_SECRET_KEY)&&void 0!==n?n:"MY_SECRET_KEY",t.signToken=function(e,r){return i.default.sign(e,t.JWT_SECRET_KEY,r)}},565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=r(7042);t.default=n.logger},7042:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;var o=n(r(7773));t.logger=o.default.createLogger({level:"info",format:o.default.format.json(),defaultMeta:{service:"user-service"},transports:[new o.default.transports.File({filename:"logs/error.log",level:"error"}),new o.default.transports.File({filename:"logs/combined.log"})]})},4527:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.error=function(e){return{message:e.message}},e}();t.default=r},2424:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkPermission=t.getRole=t.rules=t.ROLE_LIST=void 0,t.ROLE_LIST={ADMINISTRATOR:{id:1,name:"管理者"},LEADER:{id:2,name:"リーダー"},DEVELOPER:{id:3,name:"開発者"},CLIENT:{id:4,name:"クライアント"},CLIENT_LEADER:{id:5,name:"クライアントリーダー"}},t.rules={ADMINISTRATOR:{static:["project:update","project:remove","member:read","feature-suggestion:update","chat-room:create","chat-room:update","chat-room:remove"],dynamic:{"member:add":function(e){var r=e.targetRoleId;return!!r&&r!==t.ROLE_LIST.ADMINISTRATOR.id},"member:update":function(e){var r=e.targetRoleId;return!!r&&r!==t.ROLE_LIST.ADMINISTRATOR.id},"member:remove":function(e){var r=e.targetRoleId;return!!r&&r!==t.ROLE_LIST.ADMINISTRATOR.id}}},LEADER:{static:["project:update","member:read","chat-room:create","chat-room:update","chat-room:remove"],dynamic:{"member:add":function(e){return e.targetRoleId!==t.ROLE_LIST.ADMINISTRATOR.id&&e.targetRoleId!==t.ROLE_LIST.LEADER.id},"member:update":function(e){return e.targetRoleId!==t.ROLE_LIST.ADMINISTRATOR.id&&e.targetRoleId!==t.ROLE_LIST.LEADER.id},"member:remove":function(e){var r=e.targetRoleId;return!!r&&r!==t.ROLE_LIST.ADMINISTRATOR.id},"feature-suggestion:update":function(e){return void 0!==e.clientApproval}}},CLIENT_LEADER:{static:["member:read","chat-room:create","chat-room:update","chat-room:remove"],dynamic:{"member:add":function(e){var r=e.targetRoleId;return!!r&&r===t.ROLE_LIST.CLIENT.id},"feature-suggestion:update":function(e){return void 0!==e.vendorApproval}}},DEVELOPER:{static:["member:read"],dynamic:{"feature-suggestion:update":function(e){var t=e.vendorApproval,r=e.clientApproval;return void 0===t&&void 0===r}}},CLIENT:{static:["member:read"],dynamic:{"feature-suggestion:update":function(e){var t=e.vendorApproval,r=e.clientApproval;return void 0===t&&void 0===r}}}},t.getRole=function(e){return Object.values(t.ROLE_LIST).find((function(t){return t.id===e}))},t.checkPermission=function(e,r,n){var o=Object.keys(t.ROLE_LIST).find((function(r){return t.ROLE_LIST[r].id===e}));if(void 0===o)return!1;if(t.rules[o].static.includes(r))return!0;var i=t.rules[o].dynamic[r];return!(!i||!n)&&i(n)}},3524:e=>{e.exports=require("@prisma/client")},5423:e=>{e.exports=require("@prisma/client/runtime")},7096:e=>{e.exports=require("bcrypt")},3582:e=>{e.exports=require("cors")},6860:e=>{e.exports=require("express")},9344:e=>{e.exports=require("jsonwebtoken")},3511:e=>{e.exports=require("passport")},4253:e=>{e.exports=require("passport-github2")},136:e=>{e.exports=require("passport-jwt")},7055:e=>{e.exports=require("passport-local")},3236:e=>{e.exports=require("reflect-metadata")},3952:e=>{e.exports=require("socket.io")},6896:e=>{e.exports=require("tsyringe")},7773:e=>{e.exports=require("winston")},3685:e=>{e.exports=require("http")}},t={};!function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(9039)})();